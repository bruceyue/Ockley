function EditorTabs(b){var i=$(b);var c=false;i.tabs().find(".ui-tabs-nav").sortable({axis:"x"});i.bind("tabsselect",{createNew:this.createNew},function(k,l){var j=$(l.tab);switch(j.attr("href")){case"#tabs-new":k.data.createNew();return false;break;default:a(j);break}return true});function h(j){return i.find("a[href="+j+"]")}function g(){return i.find("ul.ui-tabs-nav li a")}function e(){return i.tabs("length")}function f(){return i.find("ul.ui-tabs-nav li.ui-tabs-selected a")}function a(l,j){if(j||c){d()}var k=l.data("editor");if(k!=null){k.refresh()}}function d(){c=true;var j=i.innerWidth()-6;var k=i.innerHeight()-6;var l=i.find(".ui-tabs-nav");k-=l.outerHeight();i.find(".ui-tabs-panel, .editorContainer, .CodeMirror, .CodeMirror-scroll").width(j).height(k)}this.setSelected=function(j){i.tabs("select",j)};this.getSelected=function(){return f().attr("href")};this.findByData=function(j,k){return g().map(function(l,n){var m=$(this);if(m.data(j)===k){return m.attr("href")}})};this.getData=function(j,k){return h(j).data(k)};this.getEditor=function(j){if(j==null){j=this.getSelected()}return h(j).data("editor")};this.refresh=function(j){var k=f();a(k,j)};this.createNew=function(u){var l=$.extend({title:"Untitled",text:null,data:null,mode:"apex"},u);var q=e();var p=q-1;var j="#tabs-"+q;i.tabs("add",j,l.title,p);var k=h(j);var s=i.find(j);var r=$("<div class='editorContainer'><textarea class='editor' ></textarea></div>");s.append(r);var n=s.find(".editor:first")[0];var o=CodeMirror.fromTextArea(n,{lineNumbers:true,value:n.value,height:"auto",mode:l.mode,indentUnit:2,indentWithTabs:false,tabMode:"shift",enterMode:"keep",electricChars:false,onCursorActivity:function(){var w=o.ockley.currentLineNumber;var v=o.getCursor().line;if(w!=v){o.setLineClass(w,null);o.ockley.currentLineNumber=v;o.setLineClass(v,"currentLine")}}});if(!o.hasOwnProperty("ockley")){o.ockley={}}if(!o.ockley.hasOwnProperty("currentLineNumber")){o.ockley.currentLineNumber=0}o.setLineClass(0,"currentLine");s.find(".CodeMirror").addClass("ui-corner-all");if(l.text!=null){o.setValue(l.text)}var m=l.data;if(m!=null){for(var t in m){if(m.hasOwnProperty(t)){k.data(t,m[t])}}}k.data("editor",o);this.setSelected(p)}};